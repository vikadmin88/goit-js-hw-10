{"version":3,"file":"commonHelpers.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\niziToast.settings({\n  position: \"topRight\",\n  timeout: 4000,\n  resetOnHover: true,\n  transitionIn: \"flipInX\",\n  transitionOut: \"flipOutX\"\n});\n\nconst inputField = document.querySelector(\"#datetime-picker\");\nconst startBtn = document.querySelector(\"button[data-start]\");\nstartBtn.addEventListener(\"click\", (e) => {\n  timer.start(selectedTime);\n  if (!startBtn.classList.contains(\"btn-disabled\")) {\n    startBtn.classList.add(\"btn-disabled\");\n    inputField.classList.add(\"input-disabled\");\n  }\n});\n\nlet selectedTime;\n\nflatpickr(\"#datetime-picker\", {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  dateFormat: \"Y-m-d H:i\",\n  minuteIncrement: 1,\n  onClose(selectedDates) {\n    const dtNow = new Date();\n    const stampNow = dtNow.setSeconds(0,0);\n    const stampSel = Date.parse(selectedDates[0]);\n\n    if (stampNow < stampSel) {\n      iziToast.success({message: \"You have selected a correct date in the future!\"});\n      selectedTime = stampSel;\n\n      if (startBtn.classList.contains(\"btn-disabled\")) {\n        startBtn.classList.remove(\"btn-disabled\");\n        inputField.classList.remove(\"input-disabled\");\n      }\n\n    } else {\n      timer.stop();\n      this.setDate(dtNow);\n      iziToast.error({message: \"Please choose a date in the future!\"});\n\n      if (!startBtn.classList.contains(\"btn-disabled\")) {\n        startBtn.classList.add(\"btn-disabled\");\n        inputField.classList.add(\"input-disabled\");\n      }\n    }\n  },\n});\n\n\nconst timer = {\n  intervalId: null,\n  intervalMs: 1000,\n  timeObj: {},\n  selectedTime: 0,\n  valuesElem: {},\n\n  init(valElemsObj, finishFn = null) {\n    this.valuesElem = valElemsObj;\n    if (finishFn) {\n      this.finishFn = finishFn;\n    }\n  },\n\n  start(selectedTime) {\n    if (this.intervalId) {\n      iziToast.info({message: \"Timer in progress! To restart refresh this page.\"});\n      return;\n    }\n    this.selectedTime = selectedTime;\n    const timeDelta = selectedTime - Date.now();\n    if (timeDelta <= 0) {\n      iziToast.error({message: \"Please choose a date in the future!\"});\n      return;\n    }\n    this.timeObj = this.millisToObj(timeDelta);\n    Object.keys(this.timeObj).forEach(it => {\n        this.valuesElem[it].textContent = this.timeObj[it].toString().padStart(2, \"0\");\n    });\n    this.intervalId = setInterval(() => this.updateValuesElem(), this.intervalMs);\n  },\n\n  updateValuesElem() {\n    const timeDelta = this.selectedTime - Date.now();\n    if (timeDelta <= 0) {\n      this.stop();\n      this.finishFn();\n      return;\n    }\n\n    const newTimeObj = this.millisToObj(timeDelta);\n    Object.keys(this.timeObj).forEach(it => {\n      if (this.timeObj[it] != newTimeObj[it]) {\n        this.timeObj[it] = newTimeObj[it];\n        this.valuesElem[it].textContent = newTimeObj[it].toString().padStart(2, \"0\");\n      }\n    });\n  },\n\n  stop() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = 0;\n    }\n  },\n\n  finishFn: () => {\n    iziToast.success({message: \"FINISH: INTERNAL function call!\"});\n  },\n\n  millisToObj(ms) {\n    const second = 1000;\n    const minute = second * 60;\n    const hour = minute * 60;\n    const day = hour * 24;\n    const days = Math.floor(ms / day);\n    const hours = Math.floor((ms % day) / hour);\n    const minutes = Math.floor(((ms % day) % hour) / minute);\n    const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n    return { days, hours, minutes, seconds };\n  },\n}\n\nconst valElemsObj = {\n  days: document.querySelector(\"span[data-days]\"),\n  hours: document.querySelector(\"span[data-hours]\"),\n  minutes: document.querySelector(\"span[data-minutes]\"),\n  seconds: document.querySelector(\"span[data-seconds]\")\n};\n\ntimer.init(valElemsObj,timerFinishExtFn);\n\nfunction timerFinishExtFn(){\n  iziToast.success({message: \"FINISH: EXTERNAL function call!\"});\n}\n\n\n\n"],"names":["iziToast","inputField","startBtn","e","timer","selectedTime","flatpickr","selectedDates","dtNow","stampNow","stampSel","valElemsObj","finishFn","timeDelta","it","newTimeObj","ms","days","hours","minutes","seconds","timerFinishExtFn"],"mappings":"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"}