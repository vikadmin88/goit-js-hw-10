{"version":3,"file":"commonHelpers.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\niziToast.settings({\n  position: \"topRight\",\n  timeout: 4000,\n  resetOnHover: true,\n  transitionIn: \"flipInX\",\n  transitionOut: \"flipOutX\"\n});\n\nlet selectedTime;\nconst inputField = document.querySelector(\"#datetime-picker\");\nconst startBtn = document.querySelector(\"button[data-start]\");\n\nstartBtn.addEventListener(\"click\", (e) => {\n  timer.start(selectedTime);\n  switchBtn(\"On\");\n});\n\n\nfunction switchBtn(switcher = \"Off\") {\n  let isBtnDisabled = startBtn.classList.contains(\"btn-disabled\");\n  if (switcher === \"On\" && isBtnDisabled) {\n    startBtn.classList.remove(\"btn-disabled\");\n    inputField.classList.remove(\"input-disabled\");\n  } else if (!isBtnDisabled) {\n    startBtn.classList.add(\"btn-disabled\");\n    inputField.classList.add(\"input-disabled\");\n  }\n}\n\nflatpickr(\"#datetime-picker\", {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  dateFormat: \"Y-m-d H:i\",\n  minuteIncrement: 1,\n  onClose(selectedDates) {\n    const dtNow = new Date();\n    const stampNow = dtNow.setSeconds(0,0);\n    const stampSel = Date.parse(selectedDates[0]);\n\n    if (stampNow < stampSel) {\n      selectedTime = stampSel;\n      switchBtn(\"On\");\n      iziToast.success({message: \"You have selected a correct date in the future!\"});\n\n    } else {\n      timer.stop();\n      this.setDate(dtNow);\n      switchBtn(\"Off\");\n      iziToast.error({message: \"Please choose a date in the future!\"});\n    }\n  },\n});\n\n\nconst timer = {\n  intervalId: null,\n  intervalMs: 1000,\n  dtObj: {},\n  selectedTime: 0,\n  pageElems: {},\n\n  init(pageElemsObj, finishFnc = null) {\n    this.pageElems = pageElemsObj;\n    if (finishFnc) {\n      this.finishFnc = finishFnc;\n    }\n  },\n\n  start(selectedTime) {\n    if (this.intervalId) {\n      iziToast.info({message: \"Timer in progress! To restart, refresh this page.\"});\n      return;\n    }\n    this.selectedTime = selectedTime;\n    const timeDelta = selectedTime - Date.now();\n    if (timeDelta <= 0) {\n      iziToast.error({message: \"Please choose a date in the future!\"});\n      return;\n    }\n    this.dtObj = this.millisToObj(timeDelta);\n    Object.keys(this.dtObj).forEach(it => {\n        this.pageElems[it].textContent = this.dtObj[it].toString().padStart(2, \"0\");\n    });\n    this.intervalId = setInterval(() => this.updValues(), this.intervalMs);\n  },\n\n  updValues() {\n    const timeDelta = this.selectedTime - Date.now();\n    if (timeDelta <= 0) {\n      this.stop();\n      this.finishFnc();\n      return;\n    }\n\n    const newTimeObj = this.millisToObj(timeDelta);\n    Object.keys(this.dtObj).forEach(it => {\n      if (this.dtObj[it] != newTimeObj[it]) {\n        this.dtObj[it] = newTimeObj[it];\n        this.pageElems[it].textContent = newTimeObj[it].toString().padStart(2, \"0\");\n      }\n    });\n  },\n\n  stop() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = 0;\n    }\n  },\n\n  millisToObj(ms) {\n    const second = 1000;\n    const minute = second * 60;\n    const hour = minute * 60;\n    const day = hour * 24;\n    const days = Math.floor(ms / day);\n    const hours = Math.floor((ms % day) / hour);\n    const minutes = Math.floor(((ms % day) % hour) / minute);\n    const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n    return { days, hours, minutes, seconds };\n  },\n\n  finishFnc: () => {\n    iziToast.success({message: \"FINISH: Object INTERNAL function invoked!\"});\n  },\n}\n\nconst pageElemsObj = {\n  days: document.querySelector(\"span[data-days]\"),\n  hours: document.querySelector(\"span[data-hours]\"),\n  minutes: document.querySelector(\"span[data-minutes]\"),\n  seconds: document.querySelector(\"span[data-seconds]\")\n};\n\ntimer.init(pageElemsObj, timerFinishExtFnc);\n// as a variant: can invoke internal \"finish\" function of obj timer\n// timer.init(pageElemsObj);\n\nfunction timerFinishExtFnc(){\n  iziToast.success({message: \"FINISH: EXTERNAL function invoked!\"});\n}\n\n\n\n"],"names":["iziToast","selectedTime","inputField","startBtn","e","timer","switchBtn","switcher","isBtnDisabled","flatpickr","selectedDates","dtNow","stampNow","stampSel","pageElemsObj","finishFnc","timeDelta","it","newTimeObj","ms","days","hours","minutes","seconds","timerFinishExtFnc"],"mappings":"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"}